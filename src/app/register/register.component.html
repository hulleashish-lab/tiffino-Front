<div class="back">
  <div class="signup-wrapper">
    <!-- Left: Image -->
    <div class="signup-image">
      <img src="https://img.freepik.com/premium-vector/illustration-vector-graphic-cartoon-character-online-registration_516790-1807.jpg" alt="Signup Illustration" />
    </div>

    <!-- Right: Form -->
    <div class="signup-container">
      <h2>Create Account</h2>

      <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">
        <!-- Step 1 -->
        <div *ngIf="step === 1">
          <!-- First Name -->
          <div class="error" *ngIf="f['firstName'].touched && f['firstName'].invalid">
            <p *ngIf="f['firstName'].errors?.['required']">First name is required</p>
          </div>
          <input type="text" formControlName="firstName" placeholder="First Name" />

          <!-- Last Name -->
          <div class="error" *ngIf="f['lastName'].touched && f['lastName'].invalid">
            <p *ngIf="f['lastName'].errors?.['required']">Last name is required</p>
          </div>
          <input type="text" formControlName="lastName" placeholder="Last Name" />

          <!-- Username -->
          <div class="error" *ngIf="f['username'].touched && f['username'].invalid">
            <p *ngIf="f['username'].errors?.['required']">Username is required</p>
          </div>
          <input type="text" formControlName="username" placeholder="Username" />

          <!-- Email -->
          <div class="error" *ngIf="f['email'].touched && f['email'].invalid">
            <p *ngIf="f['email'].errors?.['required']">Email is required</p>
            <p *ngIf="f['email'].errors?.['email']">Enter a valid email</p>
          </div>
          <input type="email" formControlName="email" placeholder="Email Address" />

          <!-- Phone -->
          <div class="error" *ngIf="f['phoneNumber'].touched && f['phoneNumber'].invalid">
            <p *ngIf="f['phoneNumber'].errors?.['required']">Phone number is required</p>
            <p *ngIf="f['phoneNumber'].errors?.['pattern']">Enter a valid 10-digit number</p>
          </div>
          <input type="text" formControlName="phoneNumber" placeholder="Mobile Number" />

          <!-- Password -->
          <div class="error" *ngIf="f['password'].touched && f['password'].invalid">
            <p *ngIf="f['password'].errors?.['required']">Password is required</p>
            <p *ngIf="f['password'].errors?.['minlength']">Password must be at least 6 characters</p>
          </div>
          <input type="password" formControlName="password" placeholder="Password" />

          <!-- Confirm Password -->
          <div class="error" *ngIf="f['confirmPassword'].touched && f['confirmPassword'].invalid">
            <p *ngIf="f['confirmPassword'].errors?.['required']">Confirm password is required</p>
          </div>
          <input type="password" formControlName="confirmPassword" placeholder="Confirm Password" />

          <!-- Next Button -->
          <button type="button" (click)="nextStep()" >Next</button>
        </div>

        <!-- Step 2 -->
        <div *ngIf="step === 2">
          <!-- Date of Birth -->
          <div class="error" *ngIf="f['dob'].touched && f['dob'].invalid">
            <p *ngIf="f['dob'].errors?.['required']">Date of birth is required</p>
          </div>
          <input type="date" formControlName="dob" placeholder="Date of Birth" />

          <!-- Roles -->
          <div class="error" *ngIf="f['roles'].touched && f['roles'].invalid">
            <p *ngIf="f['roles'].errors?.['required']">At least one role is required</p>
          </div>
          <select formControlName="roles" multiple>
            <option value="USER">User</option>
            <option value="ADMIN">Admin</option>
            <option value="DELIVERY_PARTNER">Delivery Partner</option>
          </select>

          <!-- Dietary Preferences -->
          <div class="error" *ngIf="f['dietaryPreferences'].touched && f['dietaryPreferences'].invalid">
            <p *ngIf="f['dietaryPreferences'].errors?.['required']">Please select your dietary preferences</p>
          </div>
          <select formControlName="dietaryPreferences" multiple>
            <option value="Vegetarian">Vegetarian</option>
            <option value="Vegan">Vegan</option>
            <option value="Keto">Keto</option>
            <option value="High-Protein">High-Protein</option>
            <option value="Low-Carb">Low-Carb</option>
          </select>

          <!-- Allergen Preferences -->
          <div class="error" *ngIf="f['allergenPreferences'].touched && f['allergenPreferences'].invalid">
            <p *ngIf="f['allergenPreferences'].errors?.['required']">Please select any allergen preferences</p>
          </div>
          <select formControlName="allergenPreferences" multiple>
            <option value="Dairy-free">Dairy-free</option>
            <option value="Nut-free">Nut-free</option>
            <option value="Gluten-free">Gluten-free</option>
          </select>

          <!-- Profile Image -->
          <div class="error" *ngIf="f['profileImage'].touched && f['profileImage'].invalid">
            <p *ngIf="f['profileImage'].errors?.['required']">Profile Image is required</p>
          </div>
          <input type="file" formControlName="profileImage" placeholder="Upload Profile Image" />

          <!-- Terms -->
          <div class="form-check mt-3">
            <input class="form-check-input" type="checkbox" formControlName="terms" id="checkChecked" />
            <label class="form-check-label" for="checkChecked">
              I agree to Tiffino's
              <a href="#" class="text-danger">Terms of Service</a>,
              <a href="#" class="text-danger">Privacy Policy</a> and
              <a href="#" class="text-danger">Content Policies</a>.
            </label>
          </div>

          <!-- Back and Submit Buttons -->
          <div class="button-group">
            <button type="button" (click)="prevStep()">Back</button>
            <button type="submit" [disabled]="!signupForm.valid">Create Account</button>
          </div>
        </div>
      </form>

      <button class="google-signin-btn">
        <img src="./assets/icons8.png" alt="Google" width="20" />
        Continue with Google
      </button>

      <div class="signup-prompt">
        <h4>Already Login?</h4>
        <h4><a routerLink="/login">Login</a></h4>
      </div>
    </div>
  </div>
</div>

<!-- Popup for Successful Registration -->
<div class="popup-overlay" *ngIf="showpopup">
  <div class="popup-card">
    <div class="popup-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="green" class="bi bi-check" viewBox="0 0 16 16">
        <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z" />
      </svg>
    </div>
    <h4>Registration Successful</h4>
    <p><strong>ID:</strong> {{ userData?.id }}</p>
    <p><strong>Name:</strong> {{ userData?.firstName }} {{ userData?.lastName }}</p>
    <p><strong>Email:</strong> {{ userData?.email }}</p>
    <p><strong>Phone:</strong> {{ userData?.phoneNumber }}</p>
    <p><strong>DOB:</strong> {{ userData?.dob }}</p>
    <h4><a routerLink="/login" class="btn btn-danger">Login</a></h4>
  </div>
</div>